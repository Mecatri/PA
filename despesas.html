<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Controle de Gastos - Casamento ¬∑ Modern</title>

<!-- Modern fonts -->
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
:root{
    --bg:#fbfaf7;
    --card:#ffffff;
    --muted:#7a7a7a;
    --accent:#8B5E3C;
    --accent-2:#D9B873;
    --success:#3a9d56;
    --danger:#c9302c;
    --warn:#c87f00;
    --shadow:0 8px 24px rgba(22,22,22,0.08);
    --radius:14px;
}

*{box-sizing:border-box;}
html,body{height:100%;}
body{
    margin:0;
    font-family:'Poppins',system-ui;
    background:linear-gradient(180deg,#fbfaf7 0%,#fffefc 100%);
    color:#222;
    padding:20px;
}

/* container */
.container{
    max-width:1100px;
    margin:0 auto;
    background:linear-gradient(180deg,rgba(255,255,255,0.98),rgba(255,255,255,0.96));
    border-radius:18px;
    padding:20px;
    box-shadow:var(--shadow);
}

/* header */
.header{text-align:center;margin-bottom:14px;}
.header h1{
    margin:0;
    font-family:'Playfair Display',serif;
    font-size:1.6rem;
    color:var(--accent);
}
.header p{margin:6px 0 0;color:var(--muted);}

/* SUMMARY */
.summary{
    display:flex;
    flex-wrap:wrap;
    gap:12px;
    margin:18px 0;
}
.card{
    background:var(--card);
    border-radius:12px;
    padding:12px 14px;
    box-shadow:0 6px 18px rgba(20,20,20,0.05);
    flex:1 1 30%;
    min-width:180px;
    display:flex;
    flex-direction:column;
    gap:6px;
}
.card .label{font-weight:600;color:var(--muted);font-size:0.9rem;}
.card .value{font-weight:800;font-size:1.15rem;color:var(--accent);}
.card.pago .value{color:#d9534f;}
.card.apagar .value{color:var(--accent-2);}
.card.geral .value{color:var(--success);}
.btn-edit-orc{
    background:linear-gradient(90deg,var(--accent),#6f4a2f);
    color:white;border:none;padding:8px 10px;border-radius:10px;cursor:pointer;
    box-shadow:0 6px 12px rgba(139,94,60,0.12);font-weight:700;
}

/* FORM */
.form{
    background:linear-gradient(180deg,#fff,#fbfbfb);
    border-radius:12px;
    padding:14px;
    display:grid;
    gap:10px;
    box-shadow:0 6px 14px rgba(18,18,18,0.03);
}
.form-grid{display:grid;gap:10px;}
@media (min-width:900px){.form-grid{grid-template-columns:1fr 1fr 1fr 1fr 200px;}}
@media (max-width:899px){.form-grid{grid-template-columns:1fr 1fr;}}
@media (max-width:520px){.form-grid{grid-template-columns:1fr;}}

.input, select{
    padding:10px 12px;
    border-radius:10px;
    border:1px solid #e6e6e6;
    font-size:0.95rem;
    background:#fff;
    width:100%;
}
.btn-primary{
    background:linear-gradient(90deg,var(--accent-2),#cd9f52);
    border:none;
    color:#fff;
    padding:10px 12px;
    border-radius:12px;
    font-weight:800;
    cursor:pointer;
    box-shadow:0 6px 14px rgba(205,159,82,0.16);
}

/* TABLE */
.table-wrap{margin-top:18px;}
table{width:100%;border-collapse:collapse;min-width:720px;}
th,td{padding:12px 10px;text-align:left;border-bottom:1px solid #f1f1f1;font-size:0.95rem;}
th{background:var(--accent);color:white;font-weight:700;}
.row-action{
    display:flex;
    flex-direction:column; /* <-- Bot√µes agora em coluna */
    gap:6px;
    justify-content:center;
    align-items:flex-end;
}
.btn-small{
    padding:6px 10px;
    border-radius:8px;
    border:none;
    cursor:pointer;
    font-weight:700;
    font-size:0.9rem;
    min-width:70px;
    text-align:center;
}
.btn-edit{background:#fff7ec;color:#8b5e3c;}
.btn-delete{background:#fff0f0;color:var(--danger);}

/* alert */
.alert-orange td{background:#fff7ee;color:var(--warn);font-weight:700;}
.alert-red td{background:#fff0f0;color:var(--danger);font-weight:700;}

/* MOBILE */
@media (max-width:760px){
    table,thead,tbody,th,td,tr{display:block;}
    thead{display:none;}
    tr{margin:10px 0;background:#fff;border-radius:12px;padding:12px;box-shadow:0 6px 18px rgba(10,10,10,0.03);}
    td{border:none;padding:8px 6px;}
    td::before{
        content:attr(data-label);
        display:inline-block;
        width:120px;
        font-weight:700;
        color:var(--muted);
    }
    .row-action{
        flex-direction:column; /* Mant√©m os bot√µes um embaixo do outro no mobile */
        align-items:stretch;
    }
    .btn-small{
        font-size:0.85rem;
    }
}

/* MODAL */
.modal-backdrop{
    position:fixed;inset:0;background:rgba(10,10,10,0.45);
    display:none;align-items:center;justify-content:center;z-index:999;
}
.modal{
    background:var(--card);
    border-radius:12px;
    padding:18px;
    width:clamp(320px,80%,720px);
    box-shadow:0 12px 32px rgba(20,20,20,0.18);
}
.modal h3{margin:0 0 8px;color:var(--accent);font-family:'Playfair Display',serif;}
.modal .row{display:grid;gap:8px;margin-bottom:10px;}
@media(min-width:700px){.modal .row{grid-template-columns:1fr 1fr;}}
.small{font-size:0.85rem;color:var(--muted);}

/* utility */
.sr-only{
    position:absolute!important;
    width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0;
}
.controls {display:flex;gap:8px;align-items:center;justify-content:flex-end;margin-top:10px;}
.controls .btn-clear{background:#f5f5f5;border-radius:10px;padding:8px 12px;border:1px solid #eee;cursor:pointer;}
</style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>üíç Controle de Gastos do Casamento</h1>
        <p class="small">Resumo financeiro, vencimentos e gerenciamento ‚Äî moderno e responsivo.</p>
    </div>

    <section class="summary" aria-hidden="false">
        <div class="card pago"><div class="label">Pago ‚Äî Noivo</div><div class="value" id="total-pago-noivo">R$ 0,00</div></div>
        <div class="card pago"><div class="label">Pago ‚Äî Noiva</div><div class="value" id="total-pago-noiva">R$ 0,00</div></div>
        <div class="card geral"><div class="label">Total Pago</div><div class="value" id="total-pago-geral">R$ 0,00</div></div>
        <div class="card apagar"><div class="label">A Pagar ‚Äî Noivo</div><div class="value" id="total-apagar-noivo">R$ 0,00</div></div>
        <div class="card apagar"><div class="label">A Pagar ‚Äî Noiva</div><div class="value" id="total-apagar-noiva">R$ 0,00</div></div>
        <div class="card apagar"><div class="label">Total a Pagar</div><div class="value" id="total-apagar-geral">R$ 0,00</div></div>
    </section>

    <form id="form" class="form" aria-label="Adicionar gasto">
        <div class="form-grid">
            <label for="item" class="sr-only">Item</label>
            <input id="item" class="input" type="text" placeholder="Item" required aria-required="true" />

            <label for="valor" class="sr-only">Valor (R$)</label>
            <input id="valor" class="input" type="number" min="0" step="0.01" inputmode="decimal" pattern="[0-9]+([.,][0-9]{1,2})?" placeholder="Valor (R$)" required aria-required="true" />

            <label for="status" class="sr-only">Status</label>
            <select id="status" class="input" required aria-required="true" >
                <option value="" disabled selected>Status</option>
                <option value="Pago">Pago</option>
                <option value="A Pagar">A Pagar</option>
            </select>

            <label for="responsavel" class="sr-only">Respons√°vel</label>
            <select id="responsavel" class="input" required aria-required="true" >
                <option value="" disabled selected>Respons√°vel</option>
                <option value="Noivo">Noivo</option>
                <option value="Noiva">Noiva</option>
            </select>

            <label for="data" class="sr-only">Data</label>
            <input id="data" class="input" type="date" placeholder="Data" />
        </div>

        <div style="display:flex;gap:8px;align-items:center;justify-content:space-between;margin-top:8px;">
            <div style="display:flex;gap:8px;">
                <button type="submit" class="btn-primary">Adicionar Gasto</button>
                <button type="button" id="export-csv" class="btn-clear">Exportar CSV</button>
                <button type="button" id="clear-all" class="btn-clear">Limpar todos</button>
            </div>
            <div class="small">Os lan√ßamentos s√£o salvos localmente no navegador.</div>
        </div>
    </form>

    <div class="table-wrap" role="region" aria-label="Lista de gastos">
        <table id="tabela">
            <thead>
                <tr><th scope="col">Item</th><th scope="col">Valor</th><th scope="col">Status</th><th scope="col">Respons√°vel</th><th scope="col">Data</th><th scope="col">A√ß√µes</th></tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

<div class="modal-backdrop" id="modal-backdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-title" aria-describedby="modal-desc">
        <h3 id="modal-title">Editar Lan√ßamento</h3>
        <div id="modal-desc" class="small" style="margin-bottom:8px;">Atualize os dados e clique em salvar.</div>

        <div class="row">
            <div><label class="small" for="edit-item">Item</label><input id="edit-item" class="input" type="text" /></div>
            <div><label class="small" for="edit-valor">Valor</label><input id="edit-valor" class="input" type="number" min="0" step="0.01" inputmode="decimal" /></div>
        </div>
        <div class="row">
            <div><label class="small" for="edit-status">Status</label>
                <select id="edit-status" class="input"><option>Pago</option><option>A Pagar</option></select></div>
            <div><label class="small" for="edit-resp">Respons√°vel</label>
                <select id="edit-resp" class="input"><option>Noivo</option><option>Noiva</option></select></div>
        </div>
        <label class="small" for="edit-data">Data</label><input id="edit-data" class="input" type="date" />
        <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:14px;">
            <button id="cancel-edit" class="btn-small" style="background:#f0f0f0;">Cancelar</button>
            <button id="save-edit" class="btn-primary">Salvar</button>
        </div>
    </div>
</div>

<script>
/*
  Melhorias inclu√≠das:
  - acessibilidade: labels escondidos, roles/aria no modal e na tabela
  - persist√™ncia local via localStorage
  - export CSV e limpar todos
  - foco e fechamento do modal com ESC e clique no backdrop
  - valida√ß√µes extras no formul√°rio de edi√ß√£o e cria√ß√£o
  - corre√ß√£o na soma por respons√°vel (somente "Noivo" e "Noiva"
